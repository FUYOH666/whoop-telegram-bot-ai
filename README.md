# RAS Telegram Bot

Личный метроном дня: 6 осознанных пингов для самосовершенствования.

## Быстрый старт

```bash
cd /Users/aleksandrmordvinov/development/RAS-TGbot && uv run python -m ras_bot.main
```

Или из любого места (если вы в директории проекта):

```bash
uv run python -m ras_bot.main
```

## Описание

RAS Bot — это не просто бот с напоминаниями. Это личный метроном дня, который помогает поддерживать эталонный ритм через 6 мягких касаний и программирует подсознание на успех и изобилие.

**Философия:** Каждое сообщение использует принципы нейролингвистического программирования (НЛП) — позитивные утверждения в настоящем времени, визуализацию успеха, образы изобилия и больших чеков. Это не просто напоминания, а программа для подсознания на создание финансовой свободы.

**6 слотов дня:**

1. **S1 — Утро тела** (07:30) — подъём, завтрак, зал/море
2. **S2 — Опора "я есть"** (09:30) — 5–10 минут тишины и практики
3. **S3 — Фокусный квант** (11:00) — 60–90 минут глубокой работы над главным проектом
4. **S4 — Шаг к деньгам** (14:00) — один конкретный шаг к рынку
5. **S5 — Закат и присутствие** (17:30) — море, закат, контакт с миром
6. **S6 — Вечерняя интеграция** (21:00) — честная оценка дня

## Установка

### Требования

- Python 3.12+
- [uv](https://github.com/astral-sh/uv) — менеджер пакетов

### Шаги

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd RAS-TGbot
```

2. Установите зависимости:
```bash
uv sync
```

3. Создайте файл `.env` на основе `.env.example`:
```bash
cp .env.example .env
```

4. Заполните `.env` своими данными:
- `TELEGRAM_BOT_TOKEN` — токен вашего Telegram бота (обязательно)
- `OPENROUTER_API_KEY` — ключ API от OpenRouter (обязательно)
- `TELEGRAM_USER_ID` — ваш Telegram user ID (опционально, будет установлен автоматически при первом `/start`)

5. **Настройте приватность OpenRouter** (важно для бесплатных моделей):
   - Откройте https://openrouter.ai/settings/privacy
   - Включите "Enable free endpoints that may train on inputs"
   - Включите "Enable free endpoints that may publish prompts" (опционально)
   - Сохраните настройки

6. При необходимости отредактируйте `config.yaml`:
   - Времена слотов (по умолчанию: 07:30, 09:30, 11:00, 14:00, 17:30, 21:00)
   - Промпты для программирования подсознания
   - Параметры LLM (temperature, max_tokens)

7. Запустите бота:
```bash
uv run python -m ras_bot.main
```

8. Откройте Telegram и отправьте боту команду `/start` для активации

**Важно:** Бот будет отправлять сообщения только пользователю, который отправил команду `/start`. Если вы указали `TELEGRAM_USER_ID` в `.env`, планировщик начнет работать сразу. Иначе user_id будет установлен автоматически при первом `/start`.

## Команды бота

- `/start` — приветствие и начало работы
- `/stats` — статистика выполнения слотов за 7 и 30 дней
- `/health` — проверка состояния бота и всех компонентов

## Архитектура

- **aiogram** — Telegram Bot API фреймворк
- **APScheduler** — планировщик задач для отправки слотов
- **OpenRouter + DeepSeek V3.1 (free)** — интеграция с LLM для персонализированных сообщений с программированием подсознания
- **SQLite** — хранение статистики ответов
- **pydantic-settings** — управление конфигурацией

## Особенности

- **Программирование подсознания:** Все сообщения используют принципы НЛП — утверждения в настоящем времени, визуализацию успеха, образы изобилия
- **Персонализация:** Сообщения адаптируются на основе вашей статистики выполнения слотов
- **Fallback:** Если OpenRouter недоступен, используются предзаготовленные сообщения из `config.yaml`
- **Статистика:** Отслеживание выполнения слотов и эталонных дней через команду `/stats`
- **Бесплатная модель:** Используется DeepSeek V3.1 (free) — полностью бесплатная модель с хорошим качеством

## Настройка промптов

Все промпты находятся в `config.yaml`:
- **Системный промпт** — определяет стиль и принципы программирования подсознания
- **Промпты для каждого слота** — инструкции для генерации персонализированных сообщений
- **Fallback сообщения** — используются при недоступности OpenRouter API

Вы можете редактировать промпты под свои цели и стиль общения.

## Разработка

### Запуск тестов

```bash
uv run pytest
```

### Линтинг

```bash
uv run ruff check .
uv run ruff format .
```

### Типизация

```bash
uv run pyright
```

## Деплой на сервер

Для запуска бота на сервере (чтобы работал 24/7 даже при выключенном ноутбуке) см. [DEPLOY.md](DEPLOY.md).

Кратко:
- **Docker** (рекомендуется): `docker-compose up -d`
- **Systemd**: создайте service файл для автозапуска
- **Screen/Tmux**: для быстрого тестирования

## Лицензия

MIT

